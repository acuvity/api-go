<!-- markdownlint-disable MD024 MD025 -->

# Apex API API Documentation

> Version: 1

## apex

### Analyzer

Represents an analyzer.

#### Example

```json
{
  "detectionMatchers": [
    [
      {
        "confidence": "Medium",
        "group": "Text",
        "name": "txt",
        "operator": "min"
      }
    ]
  ],
  "enabled": false
}
```

#### Relations

##### `GET /analyzers`

List of all available analyzers.

#### Attributes

##### `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

ID is the identifier of the object.

##### `description`

Type: `string`

The description of the analyzer.

##### `detectionMatchers`

Type: `[][]detectionmatcher`

A list of detection matcher that will trigger the analyzer.

##### `detectors`

Type: [`[]detector`](#detector)

The detectors the analyzer can use.

##### `enabled`

Type: `boolean`

Tell if the analyzer is enabled by default.

##### `group`

Type: `string`

The group the analyzer belongs to.

##### `models`

Type: [`[]analyzermodel`](#analyzermodel)

The models used by the analyzer.

##### `name`

Type: `string`

The name of the analyzer.

##### `namespace` [`autogenerated`,`read_only`]

Type: `string`

The namespace of the object.

### PoliceExternalUser

PoliceExternalUser holds the information about the remote user for a
PoliceRequest.

#### Example

```json
{
  "claims": [
    "@org=acuvity.ai",
    "given_name=John",
    "family_name=Doe"
  ],
  "name": "John Doe"
}
```

#### Attributes

##### `claims` [`required`]

Type: `[]string`

List of claims extracted from the user query.

##### `name` [`required`]

Type: `string`

The name of the external user.

### PoliceRequest

This is a scan and police request.

#### Example

```json
{
  "annotations": {
    "key1": "value1",
    "key2": "value2"
  },
  "anonymization": "FixedSize",
  "bypassHash": "6f37d752-bce1-4973-88f6-28b6c100ceb8",
  "messages": [
    "Summarize the main points of this article in bullet points.",
    "Generate a list of creative product names for a futuristic tech gadget."
  ],
  "model": "claude-3-7-sonnet",
  "provider": "openai",
  "tools": "{
  \"tool1\": {
      \"name\": \"tool1\",
      \"description\": \"This is a tool.\"
  }
}",
  "type": "Input"
}
```

#### Relations

##### `POST /policerequests`

Processes the scan and police request.

#### Attributes

##### `annotations`

Type: `map[string]string`

Annotations attached to the extraction.

##### `anonymization`

Type: `enum(FixedSize | VariableSize)`

How to anonymize the data. If deanonymize is true, then VariablSize is required.

Default value:

```json
"FixedSize"
```

##### `bypassHash`

Type: `string`

In the case of a contentPolicy that asks for a confirmation, this is the
hash you must send back to bypass the block. This is only useful when a
content policy has been set or is evaluated remotely.

##### `extractions`

Type: [`[]extractionrequest`](#extractionrequest)

The extractions to request.

##### `messages`

Type: `[]string`

Messages to process and provide detections for. Use data in extractions for
processing binary data.

##### `model`

Type: `string`

The model used by the request.

##### `provider`

Type: `string`

The name of the provider to use for policy resolutions. If not set, it will
default to the principal name (the application itself).

##### `tools`

Type: [`map[string]tool`](#tool)

The various tools used by the request.

##### `trace`

Type: [`traceref`](#traceref)

References to the trace of the request.

##### `type`

Type: `enum(Input | Output)`

The type of text.

##### `user`

Type: [`policeexternaluser`](#policeexternaluser)

The user information that the PoliceRequest is passing on to the policy
engine that can be used for additional policy resolution.

### PoliceResponse

This is a scan and police response.

#### Example

```json
{
  "client": "curl",
  "clientVersion": "7.64.1",
  "decision": "Deny",
  "model": "claude-3-7-sonnet",
  "principal": "{
  \"type\": \"User\",
  \"user\": {
      \"authType\": \"Certificate\",
      \"team\": \"engineers\",
      \"user\": \"someone@somewhere.com\"
  }
}",
  "provider": "openai",
  "tools": "{
  \"tool1\": {
      \"name\": \"tool1\",
      \"description\": \"This is a tool.\"
  }
}",
  "type": "Input"
}
```

#### Attributes

##### `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

ID is the identifier of the object.

##### `alerts`

Type: [`[]alertevent`](#alertevent)

List of alerts that got raised during the policy resolution.

##### `annotations`

Type: `map[string]string`

Annotations attached to the log.

##### `client`

Type: `string`

The client used to send the request.

##### `clientVersion`

Type: `string`

The version of the client used to send the request.

##### `decision`

Type: `enum(Deny | Allow | Ask | Bypassed | ForbiddenUser | Skipped)`

Tell what was the decision about the data.

##### `extractions`

Type: [`[]extraction`](#extraction)

The extractions to log.

##### `hash`

Type: `string`

The hash of the input.

##### `latency`

Type: [`latency`](#latency)

Information about latency of various stage of request and response.

##### `mcpMessage`

Type: [`mcpmessage`](#mcpmessage)

If this is an MCP message, then the MCP message details will be set here.

##### `model`

Type: `string`

The model used by the request.

##### `namespace` [`autogenerated`,`read_only`]

Type: `string`

The namespace of the object.

##### `pipelineName`

Type: `string`

The name of the particular pipeline that extracted the text.

##### `principal` [`required`]

Type: [`principal`](#principal)

The principal of the object.

##### `provider`

Type: `string`

The provider to use.

##### `reasons`

Type: `[]string`

The various reasons returned by the policy engine.

##### `summary`

Type: [`extractionsummary`](#extractionsummary)

The summary of the extractions.

##### `time`

Type: `time`

Set the time of the message request.

##### `toolChoice`

Type: [`toolchoice`](#toolchoice)

Tool choice instructions for the model of a request.

##### `tools`

Type: [`map[string]tool`](#tool)

The various tools used by the request.

##### `type`

Type: `enum(Input | Output)`

The type of text.

### ScanRequest

This is a scan request.

#### Example

```json
{
  "analyzers": [
    "Malcontents"
  ],
  "annotations": {
    "key1": "value1",
    "key2": "value2"
  },
  "anonymization": "FixedSize",
  "bypassHash": "6f37d752-bce1-4973-88f6-28b6c100ceb8",
  "keywords": [
    "legal",
    "technical",
    "scientific"
  ],
  "messages": [
    "Summarize the main points of this article in bullet points.",
    "Generate a list of creative product names for a futuristic tech gadget."
  ],
  "minimalLogging": false,
  "model": "claude-3-7-sonnet",
  "redactions": [
    "person",
    "ssn",
    "location"
  ],
  "tools": "{
  \"tool1\": {
      \"name\": \"tool1\",
      \"description\": \"This is a tool.\"
  }
}",
  "type": "Input"
}
```

#### Relations

##### `POST /scanrequests`

Processes the scan request.

#### Attributes

##### `accessPolicy`

Type: `string`

AccessPolicy allows to pass optional Rego access policy. If not set,
The action is always Allow,
If it is set, it will be run, and the final decision will be computed based
on that policy.
If the rego code does not start with package main, then the needed
classic package definition and  acuvity imports will be added
automatically.
If the code starts with package main, then everything remains untouched.

##### `analyzers`

Type: `[]string`

The analyzers parameter allows for customizing which analyzers should be used,
overriding the default selection. Each analyzer entry can optionally include a
prefix to modify its behavior:

  - No prefix: Runs only the specified analyzers and any dependencies required
for deeper analyzis (slower but more acurate).
  - '+' (enable): Activates an analyzer that is disabled by default.
  - '-' (disable): Disables an analyzer that is enabled by default.
  - '@' (direct execution): Runs the analyzer immediately, bypassing the deeper
analyzis (faster but less acurate).

An analyzers entry can be specified using:
  - The analyzer name (e.g., 'Toxicity detector')
  - The analyzer ID (e.g., 'en-text-toxicity-detector')
  - The analyzer group (e.g., 'Detectors')
  - A detector name (e.g., 'toxic')
  - A detector label (e.g., 'insult')
  - A detector group (e.g., 'Malcontents')

If left empty, all default analyzers will be executed.

##### `annotations`

Type: `map[string]string`

Annotations attached to the extraction.

##### `anonymization`

Type: `enum(FixedSize | VariableSize)`

How to anonymize the data. If deanonymize is true, then VariablSize is required.

Default value:

```json
"FixedSize"
```

##### `bypassHash`

Type: `string`

In the case of a contentPolicy that asks for a confirmation, this is the
hash you must send back to bypass the block. This is only useful when a
content policy has been set or is evaluated remotely.

##### `contentPolicy`

Type: `string`

ContentPolicy allows to pass optional Rego content policy. If not set,
The action is always Allow, and there cannot be any alerts raised etc
If it is set, it will be run, and the final decision will be computed based
on that policy.
If the rego code does not start with package main, then the needed
classic package definition and  acuvity imports will be added
automatically.
If the code starts with package main, then everything remains untouched.

##### `extractions`

Type: [`[]extractionrequest`](#extractionrequest)

The extractions to request.

##### `keywords`

Type: `[]string`

The keywords found during classification.

##### `messages`

Type: `[]string`

Messages to process and provide detections for. Use data in extractions for
processing binary data.

##### `minimalLogging`

Type: `boolean`

If true, the system will not log the contents that were scanned.

##### `model`

Type: `string`

The model used by the request.

##### `redactions`

Type: `[]string`

The redactions to perform if they are detected.

##### `tools`

Type: [`map[string]tool`](#tool)

The various tools used by the request.

##### `type`

Type: `enum(Input | Output)`

The type of text.

### ScanResponse

This is a scan response.

#### Example

```json
{
  "client": "curl",
  "clientVersion": "7.64.1",
  "decision": "Deny",
  "model": "claude-3-7-sonnet",
  "principal": "{
  \"type\": \"User\",
  \"user\": {
      \"authType\": \"Certificate\",
      \"team\": \"engineers\",
      \"user\": \"someone@somewhere.com\"
  }
}",
  "provider": "openai",
  "tools": "{
  \"tool1\": {
      \"name\": \"tool1\",
      \"description\": \"This is a tool.\"
  }
}",
  "type": "Input"
}
```

#### Attributes

##### `ID` [`identifier`,`autogenerated`,`read_only`]

Type: `string`

ID is the identifier of the object.

##### `alerts`

Type: [`[]alertevent`](#alertevent)

List of alerts that got raised during the policy resolution.

##### `annotations`

Type: `map[string]string`

Annotations attached to the log.

##### `client`

Type: `string`

The client used to send the request.

##### `clientVersion`

Type: `string`

The version of the client used to send the request.

##### `decision`

Type: `enum(Deny | Allow | Ask | Bypassed | ForbiddenUser | Skipped)`

Tell what was the decision about the data.

##### `extractions`

Type: [`[]extraction`](#extraction)

The extractions to log.

##### `hash`

Type: `string`

The hash of the input.

##### `latency`

Type: [`latency`](#latency)

Information about latency of various stage of request and response.

##### `mcpMessage`

Type: [`mcpmessage`](#mcpmessage)

If this is an MCP message, then the MCP message details will be set here.

##### `model`

Type: `string`

The model used by the request.

##### `namespace` [`autogenerated`,`read_only`]

Type: `string`

The namespace of the object.

##### `pipelineName`

Type: `string`

The name of the particular pipeline that extracted the text.

##### `principal` [`required`]

Type: [`principal`](#principal)

The principal of the object.

##### `provider`

Type: `string`

The provider to use.

##### `reasons`

Type: `[]string`

The various reasons returned by the policy engine.

##### `summary`

Type: [`extractionsummary`](#extractionsummary)

The summary of the extractions.

##### `time`

Type: `time`

Set the time of the message request.

##### `toolChoice`

Type: [`toolchoice`](#toolchoice)

Tool choice instructions for the model of a request.

##### `tools`

Type: [`map[string]tool`](#tool)

The various tools used by the request.

##### `trace`

Type: [`traceref`](#traceref)

References to the trace of the request.

##### `type`

Type: `enum(Input | Output)`

The type of text.

## core

### AlertEvent

Represents an alert event raised by a policy.

#### Example

```json
{
  "alertDefinition": "warning-notification",
  "principal": "{
  \"type\": \"User\",
  \"user\": {
      \"authType\": \"Certificate\",
      \"team\": \"engineers\",
      \"user\": \"someone@somewhere.com\"
  }
}"
}
```

#### Attributes

##### `alertDefinition` [`required`]

Type: `string`

The name of the alert definition that triggered the alert event.

##### `alertDefinitionNamespace`

Type: `string`

The namespace of the alert definition.

##### `principal` [`required`]

Type: [`principal`](#principal)

The principal of the object.

##### `provider`

Type: `string`

The provider used that the alert came from.

##### `timestamp` [`autogenerated`,`read_only`]

Type: `time`

When the alert event was raised.

### AnalyzerModel

Represent an analyzer model.

#### Attributes

##### `name`

Type: `string`

The name of the model.

##### `revision`

Type: `string`

The revision of the model.

### DetectionMatcher

Represent a detection matcher.
A Detection Matcher serves as a filtering mechanism for analyzers, determining
which detections should trigger an analysis. It allows for flexible pattern
matching on detection attributes such as name, label, and group using glob-style
wildcards. Additionally, it enables confidence-based filtering by defining
thresholds and comparison operators. Detection Matchers provide a structured way
to control when and how analyzers engage with incoming detections.

#### Example

```json
{
  "confidence": "Low",
  "group": "Text",
  "label": "txt",
  "name": "txt",
  "operator": "Min"
}
```

#### Attributes

##### `confidence`

Type: `enum(Unlikely | Low | Medium | High)`

The detection confidence level to operate on.

Default value:

```json
"Low"
```

##### `description`

Type: `string`

The description of the detection matcher.

##### `group`

Type: `string`

The group pattern used to match detection group. Supports glob-style wildcards
(e.g. 'Text*' matches 'Text', 'Text_'). Default value is '*' meaning matching
any
detection group.

Default value:

```json
"*"
```

##### `label`

Type: `string`

The label pattern used to match detection label. Supports glob-style wildcards
(e.g. 'txt*' matches 'txt', 'txtuf8'). Default value is '*' meaning matching any
detection label.

Default value:

```json
"*"
```

##### `name`

Type: `string`

The name pattern used to match detection name. Supports glob-style wildcards
(e.g. 'txt*' matches 'txt', 'txtuf8'). Default value is '*' meaning matching any
detection name.

Default value:

```json
"*"
```

##### `operator`

Type: `enum(Is | Min | Max)`

Specifies how to compare the detection's confidence value against the matcher's
threshold:
- 'Is': All Detections confidence must exactly match the threshold
- 'Min': At least one detection confidence must be greater than or equal to the
threshold
- 'Max': At least one detection confidence must be less than the threshold
The default value is 'Min'.

Default value:

```json
"Min"
```

### Detector

Represent a detector an analyzer can use.

#### Example

```json
{
  "positional": false
}
```

#### Attributes

##### `description`

Type: `string`

The description of the detection.

##### `group`

Type: `string`

The group the detection belongs to.

##### `label`

Type: `string`

The label returned by the model.

##### `name`

Type: `string`

The name of the detection.

##### `positional`

Type: `boolean`

Tell if the detection is positional.

### Extraction

Represents the extracted information to log.

#### Example

```json
{
  "PIIs": {
    "ssn": 0.8
  },
  "confidentiality": 0.9,
  "customDataTypes": {
    "my_cdt": 1
  },
  "dataSets": {
    "cds": {
      "ct1": 1,
      "ct2": 2
    }
  },
  "exploits": {
    "prompt_injection": 0.8
  },
  "intent": {
    "write": 0.8
  },
  "internal": false,
  "isFile": false,
  "isStored": false,
  "keywords": {
    "my_keywork": 0.8
  },
  "languages": {
    "english": 0.8
  },
  "malcontents": {
    "toxic": 0.8
  },
  "relevance": 0.9,
  "secrets": {
    "credentials": 0.7
  },
  "topics": {
    "category/enterprise": 0.7,
    "department/logistics": 0.8,
    "depict/document": 0.8,
    "extracted/typed_text_content": 1,
    "timeframe/current_year": 0.6
  }
}
```

#### Attributes

##### `PIIs`

Type: `map[string]float64`

The PIIs found during classification.

The current list can be obtained through the analyzers API by searching for
detector groups 'PIIs' accross all analyzers.

Example of PIIs detected: aba_routing_number, address, bank_account,
bitcoin_wallet, credit_card, driver_license, email_address, itin_number,
location, medical_license, money_amount, passport_number, person, phone_number,
ssn.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `annotations`

Type: `map[string]string`

Annotations attached to the extraction.

##### `categories`

Type: [`[]modality`](#modality)

The categories are remapping of the modalities in a more human friendly way.

##### `confidentiality`

Type: `float`

The level of general confidentiality of the input.

##### `customDataTypes`

Type: `map[string]float64`

The custom data types found during classification.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `data`

Type: `string`

The data extracted.

##### `dataSets`

Type: `map[string]map[string]float64`

The data sets found during classification.

##### `detections`

Type: [`[]textualdetection`](#textualdetection)

The textual detections found while applying policies.

##### `exploits`

Type: `map[string]float64`

The various exploits attempts.

The current list can be obtained through the analyzers API by searching for
detector groups 'Exploits' accross all analyzers.

Example of exploits detected: jailbreak, prompt_injection, malicious_url.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `hash`

Type: `string`

The hash of the extraction.

##### `intent`

Type: `map[string]float64`

The estimated intent embodied into the text.

The current list can be obtained through the analyzers API by searching for
detector groups 'Intent' accross all analyzers.

Example of intent detected: explain, outline, summarize, write.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `internal`

Type: `boolean`

If true, this extraction is for internal use only. This can be used by agentic
systems to mark an extraction as internal only as opposed to user facing.

##### `isFile`

Type: `boolean`

If true, the data of the extraction is a file.

##### `isStored`

Type: `boolean`

If true, indicates that the file has been stored.

##### `keywords`

Type: `map[string]float64`

The keywords found during classification.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `label`

Type: `string`

A means of distinguishing what was extracted, such as prompt, input file or
code.

##### `languages`

Type: `map[string]float64`

The language of the classification.

The current list can be obtained through the analyzers API by searching for
detector groups 'Languages' accross all analyzers.

Example of languages: chinese, english, french, german, gibberish, japanese,
russian, spanish.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `malcontents`

Type: `map[string]float64`

The various malcontents attempts.

The current list can be obtained through the analyzers API by searching for
detector groups 'Malcontents' accross all analyzers.

Example of malcontents: biased, harmful, toxic.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `modalities`

Type: [`[]modality`](#modality)

The modalities of data detected in the data.

##### `relevance`

Type: `float`

The level of general organization relevance of the input.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `secrets`

Type: `map[string]float64`

The secrets found during classification.

The current list can be obtained through the analyzers API by searching for
detector groups 'Secrets' accross all analyzers.

Example of secrets: adafruit, alibaba, anthropic, apideck, apify, atlassian,
aws_secret_key, buildkite, checkout, clickuppersonal, contentfulpersonalaccess,
credentials, database_url_with_credentials, databricks, denodeploy, dfuse,
digitalocean, discord_webhook, docker_hub, doppler, dropbox, endorlabs,
fleetbase, flutterwave, frameio, freshdesk, fullstory, github, gitlab,
gocardless, google_api, grafana, groq, huggingface, intra42, jwt, klaviyo,
launchdarkly, linearapi, locationiq, mailchimp, mailgun, mapbox, maxmind,
microsoft_teams_webhook, nightfall, notion, npm, openai, otp_auth_url, pagarme,
paystack, planetscale, planetscaledb, portainer, posthog, postman, prefect,
private_key, pubnub_publish, pubnub_subscribe, pulumi, ramp, razorpay, readme,
rechargepayments, replicate, rubygems, salesforce, sendgrid, sendinblue,
shopify, slack_access, slack_bot, slack_refresh, slack_user, slack_webhook,
slack_workflow_webhook, sourcegraph, sourcegraphcody, squareapp, squareup,
stripe, supabase, tailscale, tines_webhook, trufflehog, twilio, ubidots,
voiceflow, web_url_with_credentials, zapierwebhook.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

##### `toolResults`

Type: [`[]toolresult`](#toolresult)

Tool call results which are passed in to this request.

##### `toolUses`

Type: [`[]tooluse`](#tooluse)

Tool uses as requested by a model.

##### `topics`

Type: `map[string]float64`

The topic of the classification.

The current list can be obtained through the analyzers API, with the following
conditions:
  1. Includes all analyzers EXCEPT those in the 'Modality' group
  2. Includes all analyzer detectors EXCEPT those in these groups:
    - 'Secrets'
    - 'Exploits'
    - 'Intent'
    - 'PIIs'
    - 'Malcontents'

Example of topics: category/enterprise, category/healthcare, category/medical,
category/personal, contains/blank_image, contains/certificate_signing_request,
contains/database_url, contains/handwritten_text, contains/printed_text,
contains/public_key, contains/ssh_public_key, contains/web_url,
decoded/base32_data, decoded/base58_data, decoded/base64_data,
decoded/base64_url_data, decoded/base85_data, decoded/hexadecimal_data,
decoded/puny_code_data, decoded/quoted_printable_data,
decoded/url_encoding_data, department/compliance, department/cybersecurity,
department/finance, department/human_resources,
department/information_technology, department/legal, department/logistics,
department/marketing, department/performance_evaluation,
department/product_management, department/project_management, department/sales,
department/strategy, department/support, depict/check, depict/code,
depict/document, depict/unclassified, depict/whiteboard, domain/commercial,
domain/development, domain/financial, domain/general, domain/regulatory,
domain/workforce, extracted/csv_cell_content, extracted/document_text_content,
extracted/handwritten_text_content, extracted/pdf_text_content,
extracted/pptx_text_content, extracted/spreadsheet_text_content,
extracted/typed_text_content, timeframe/current_year, timeframe/future,
timeframe/last_year, timeframe/next_year, timeframe/past,
transcribed/audio_text_content.

If a key is not present in the map that implies that entity was not detected. If
an entity is detected then the value is a score. Here's how to interpret the
scores:
  - confidence: 'low', 0 < score <0.33
  - confidence: 'medium', 0.33 <= score < 0.66
  - confidence: 'high', 0.66 <= score <= 1.

### ExtractionInformation

Represents extracted information.

#### Attributes

##### `n`

Type: `integer`

The number of times it has been seen.

### ExtractionRequest

Represents the extraction that the user wants to extract.

#### Example

```json
{
  "internal": false,
  "isFile": false,
  "isStored": false
}
```

#### Attributes

##### `annotations`

Type: `map[string]string`

Annotations attached to the extraction.

##### `data`

Type: `[]byte`

The binary data to request extraction for.

##### `internal`

Type: `boolean`

If true, this extraction is for internal use only. This can be used by agentic
systems to mark an extraction as internal only as opposed to user facing.

##### `isFile`

Type: `boolean`

If true, the data of the extraction is a file.

##### `isStored`

Type: `boolean`

If true, indicates that the file has been stored.

##### `label`

Type: `string`

A means of distinguishing what was extracted, such as prompt, input file or
code.

##### `toolResults`

Type: [`[]toolresult`](#toolresult)

Tool call results which are passed in to this request.

##### `toolUses`

Type: [`[]tooluse`](#tooluse)

Tool uses as requested by a model.

### ExtractionSummary

Represents the summary of the extractions.

#### Attributes

##### `categories`

Type: `map[string]extractioninformation`

The categories are remapping of the modalities in a more human friendly way.

##### `confidenceLevels`

Type: `map[string]extractioninformation`

The detected confidence levels.

##### `dataSets`

Type: `map[string]extractioninformation`

The detected datasets.

##### `dataTypes`

Type: `map[string]extractioninformation`

The detected dataTypes.

##### `exploits`

Type: `map[string]extractioninformation`

The various exploits attempts.

##### `intent`

Type: `map[string]extractioninformation`

The estimated intent embodied into the text.

##### `keywords`

Type: `map[string]extractioninformation`

The keywords found during classification.

##### `languages`

Type: `map[string]extractioninformation`

The language of the classification.

##### `malcontents`

Type: `map[string]extractioninformation`

The various malcontents attempts.

##### `modalities`

Type: `map[string]extractioninformation`

The modalities of data detected in the data.

##### `topics`

Type: `map[string]extractioninformation`

The topic of the classification.

### Latency

Holds information about latencies introduced by Apex.

#### Attributes

##### `accessPolicy`

Type: `integer`

How much time it took to run the access policy in nanoseconds.

##### `analysis`

Type: `integer`

How much time it took to run content analysis in nanoseconds.

##### `assignPolicy`

Type: `integer`

How much time it took to run the assign policy in nanoseconds.

##### `contentPolicy`

Type: `integer`

How much time it took to run content policy in nanoseconds.

##### `extraction`

Type: `integer`

How much time it took to run input or output extraction in nanoseconds.

### MCPMessage

Represents MCP message details.

#### Example

```json
{
  "direction": "Client2Server",
  "isError": false,
  "method": "tools/call",
  "requestID": "2",
  "sessionID": "1f02aa20-22d8-6e87-8432-be15d4f7b5b2",
  "type": "Request"
}
```

#### Attributes

##### `direction` [`required`]

Type: `enum(Client2Server | Server2Client)`

The communication direction of the MCP message which can be from client to
server, or from server to client.

##### `isError`

Type: `boolean`

IsError is true in case if a response is an error response as opposed to a
result. Note that this is not the same as a result which has isError set to true
within the result. This is a protocol level error. This will always be false for
requests and notifications, and false for reponses when the response has a
result.

##### `method`

Type: `string`

This is the method name of the request or notification. Contrary to MCP this is
set on responses as well if possible in which case the format will be of the
form method/params.name.

##### `requestID`

Type: `string`

The ID of a request or a response. We always extract this as a string even
though this can be a string or number in MCP. It is derived from the id field of
a request or a response.

##### `sessionID`

Type: `string`

The session ID that this MCP message belongs to. This is strictly speaking not
part of MCP, and this can be empty.

##### `type` [`required`]

Type: `enum(Request | Response | Notification)`

The MCP message type which can be Request, Response or Notification.

### MCPServer

Represents an MCP server object.

#### Example

```json
{
  "allowedTools": [
    "deepwiki_search",
    "deepwiki_fetch"
  ],
  "name": "deepwiki",
  "url": "https://mcp.deepwiki.com/mcp"
}
```

#### Attributes

##### `allowedTools`

Type: `[]string`

The allowed tools that the caller has access to. If empty, this means that the
caller has access to all tools provided by this MCP server.

##### `name`

Type: `string`

The name of the MCP server.

##### `url` [`required`]

Type: `string`

The URL of the MCP server.

### MCPToolAnnotations

Represents the tool annotations as they can be optionally defined for MCP tools.

#### Example

```json
{
  "destructiveHint": false,
  "idempotentHint": false,
  "openWorldHint": false,
  "readOnlyHint": false
}
```

#### Attributes

##### `destructiveHint`

Type: `boolean`

If true, the tool may perform destructive updates.

##### `idempotentHint`

Type: `boolean`

If true, repeated calls with same args have no additional effect.

##### `openWorldHint`

Type: `boolean`

If true, tool interacts with external entities.

##### `readOnlyHint`

Type: `boolean`

If true, the tool does not modify its environment.

##### `title`

Type: `string`

Human-readable title for the tool.

### Modality

Represents the modality of a some data.

#### Example

```json
{
  "group": "image",
  "type": "png"
}
```

#### Attributes

##### `group` [`required`]

Type: `string`

The group of data.

The current list can be obtained through the analyzers API by searching for
detector groups in the 'Modality' analyzer group.

Example of group: application, archive, audio, code, document, executable, font,
image, text, unknown, video.

##### `type` [`required`]

Type: `string`

The type of data.

The current list can be obtained through the analyzers API by searching for
detector names in the 'Modality' analyzer group.

Example of type: 3dsm, 3gp, 3mf, ace, ada, ai, apk, applebplist, appleplist, ar,
arc, arj, asc, asf, asm, asp, au, autohotkey, autoit, avi, avif, awk, ax, batch,
bazel, bcad, bib, bmp, bpg, brainfuck, brf, bzip, bzip3, c, cab, cat, cdf, chm,
clojure, cmake, cobol, coff, coffeescript, com, cpl, cpp, crt, crx, cs, csproj,
css, csv, dart, deb, dex, dey, dicom, diff, django, dll, dm, dmg, dmigd,
dmscript, doc, dockerfile, docx, dotx, dwg, dxf, dylib, elf, elixir, emf, eml,
epub, erb, erlang, exe, flac, flv, fortran, fpx, gemfile, gemspec, gif,
gitattributes, gitmodules, gleam, go, gradle, groovy, gzip, h, h5, handlebars,
haskell, hcl, heif, hlp, hpp, hta, htaccess, html, hwp, icns, ico, ics,
ignorefile, ini, internetshortcut, ipynb, iso, jar, java, javabytecode,
javascript, jinja, jng, jnlp, jp2, jpeg, json, jsonl, jsx, julia, jxl, ko,
kotlin, latex, lha, license, lisp, lnk, lock, lua, lz, lz4, m3u, m4, macho,
makefile, markdown, matlab, mht, midi, mkv, mp3, mp4, mpegts, mscompress, msi,
msix, mui, mum, npy, npz, objectivec, ocaml, ocx, odex, odin, odp, ods, odt,
ogg, one, onnx, otf, outlook, pascal, pcap, pdb, pdf, pebin, pem, perl, php,
pickle, png, po, postscript, powershell, ppt, pptx, prolog, proteindb, proto,
psd, python, pythonbytecode, pytorch, qoi, qt, r, randomascii, rar, rdf, rlib,
rll, rpm, rst, rtf, ruby, rust, scala, scheme, scr, scss, sevenzip, sgml, shell,
smali, snap, so, solidity, sql, sqlite, squashfs, srt, stlbinary, stltext, sum,
svg, swf, swift, symlinktext, sys, tar, tcl, textproto, tga, thumbsdb, tiff,
toml, torrent, tsv, tsx, ttf, twig, txt, txtascii, txtutf16, txtutf8,
typescript, vba, vbe, vcxproj, verilog, vhdl, visio, vtt, vue, wad, wasm, wav,
webm, webp, webtemplate, winregistry, wma, wmf, wmv, woff, woff2, xar, xcf, xls,
xlsb, xlsx, xml, xpi, xz, yaml, yara, zig, zip, zlibstream, zst.

### Principal

Describe the principal.

#### Example

```json
{
  "IP": "192.0.2.42",
  "authType": "Certificate",
  "teams": "admins",
  "tokenName": "my-user-token",
  "type": [
    "User"
  ]
}
```

#### Attributes

##### `IP`

Type: `string`

The source IP address of the request.

##### `app`

Type: [`principalapp`](#principalapp)

The application principal information if type is App.

##### `authType`

Type: `enum(Certificate | UserToken | AppToken | Hostname | Token | ComponentToken | External)`

The type of authentication.

##### `claims`

Type: `[]string`

List of claims extracted from the user query.

##### `teams`

Type: `[]string`

The teams that were used to authorize the request.

##### `tokenName`

Type: `string`

The name of the token, if any.

##### `type` [`required`]

Type: `enum(User | App | External)`

The type of principal.

##### `user`

Type: [`principaluser`](#principaluser)

The user principal information if type is User.

### PrincipalApp

Describes the principal information of an application.

#### Example

```json
{
  "component": "frontend",
  "labels": [
    "country=us",
    "another-label"
  ],
  "name": "MyApp"
}
```

#### Attributes

##### `component`

Type: `string`

The component of the application request.

##### `labels`

Type: `[]string`

The list of labels attached to an application request.

##### `name`

Type: `string`

The name of the application.

##### `user`

Type: [`principalappuser`](#principalappuser)

The optional user information of the application request.

### PrincipalAppUser

Describes the optional principal information of the user of an application which
is being derived from a bearer token of a request.

#### Example

```json
{
  "email": "john.doe@acme.com",
  "name": "John Doe",
  "tokenValidated": false
}
```

#### Attributes

##### `email`

Type: `string`

The Email address of the user. This will be derived from the email claims of a
token like email, emailAddress or upn.

##### `name`

Type: `string`

The given name of the user. This will be derived from the common name claims of
a token like name or given_name.

##### `tokenValidated`

Type: `boolean`

This will be true if the apex was able to validate the token in the request.

### PrincipalUser

Describes the principal information of a user.

#### Example

```json
{
  "name": "user@company.com"
}
```

#### Attributes

##### `name`

Type: `string`

Identification bit that will be used to identify the origin of the request.

### TextualDetection

Represents a textual detection done by policy.

#### Example

```json
{
  "redacted": false,
  "type": "Keyword"
}
```

#### Attributes

##### `end`

Type: `integer`

The end position of the detection in the original data.

##### `key`

Type: `string`

The key that is used in the name's place, If empty, a sequence of X's are used.

##### `name`

Type: `string`

The name of the detection.

##### `redacted`

Type: `boolean`

If true this detection has been redacted.

##### `redactedEnd`

Type: `integer`

The end position of the detection in the redacted data.

##### `redactedStart`

Type: `integer`

The start position of the detection in the redacted data.

##### `score` [`max_value=1.000000`]

Type: `float`

The confidence score of the detection.

##### `start`

Type: `integer`

The start position of the detection in the original data.

##### `type`

Type: `enum(Keyword | PII | Secret | CDT)`

The type of detection.

### Tool

Represents a tool that can enhance a genAI model's capabilities.

#### Example

```json
{
  "category": "Client",
  "description": "Get the current weather in a given location",
  "name": "get_weather",
  "type": "computer_20250124"
}
```

#### Attributes

##### `MCPAnnotations`

Type: [`mcptoolannotations`](#mcptoolannotations)

For MCP tools these represent optional hints about tool behavior.

##### `MCPServer`

Type: [`mcpserver`](#mcpserver)

If category is RemoteMCP, then this describes the remote MCP server.

##### `category`

Type: `enum(Client | Server | RemoteMCP)`

The category of the tool. This relays information about where the tool is being
used. This can be empty if unknown or if this is a tool listing of MCP servers.

##### `description`

Type: `string`

The description of the tool.

##### `name`

Type: `string`

The name of the tool.

##### `type`

Type: `string`

The type of the tool as can be optionally passed by the provider.

### ToolChoice

Represents the tool choice that can be passed along together with tools.

#### Example

```json
{
  "choice": "Auto"
}
```

#### Attributes

##### `choice` [`required`]

Type: `enum(Auto | Any | None | Tool)`

Model instructions on tool choice.

Default value:

```json
"Auto"
```

##### `name`

Type: `string`

If choice is Tool, this will be set to the name of the tool to use.

### ToolResult

Represents the tool result as passed in by the user or application after calling
a tool.

#### Example

```json
{
  "callID": "toolu_019X5QaEeVTDFrQPHqMMgd1n",
  "isError": false
}
```

#### Attributes

##### `callID` [`required`]

Type: `string`

The ID of the tool use as previously returned by a models tool use response.

##### `content`

Type: `string`

The content of the tool call results.

##### `isError`

Type: `boolean`

Indicates if the tool call failed.

Default value:

```json
false
```

### ToolUse

Represents the tool use which are instructions by a model on what tool to call
and how.

#### Example

```json
{
  "callID": "toolu_019X5QaEeVTDFrQPHqMMgd1n",
  "name": "get_weather",
  "serverName": "deepwiki"
}
```

#### Attributes

##### `callID` [`required`]

Type: `string`

The ID of the tool use which the user or application must pass when posting back
the tool call results.

##### `input`

Type: `string`

The input to the tool call. This should be a JSON object which must conform to
the JSON schema as was previously defined for the tool.

##### `name` [`required`]

Type: `string`

The name of the tool to call.

##### `serverName`

Type: `string`

The name of the remote MCP server that will execute this call.

### TraceRef

Holds all references to a trace which are also the essentials of the span data.

#### Example

```json
{
  "kind": "Server",
  "parentSpanID": "00f067aa0ba902b7",
  "spanEnd": "2025-03-22T14:35:00.123456789Z",
  "spanID": "6ba80aaa3b2f43d8",
  "spanName": "acuvity_prompt_input_analysis",
  "spanStart": "2025-03-22T14:35:00.123456789Z",
  "statusCode": "OK",
  "statusMessage": "Failed to make API call to service Foo.",
  "traceID": "4bf92f3577b34da6a3ce929d0e0e4736",
  "transparentSpanID": "6ba80aaa3b2f43d8"
}
```

#### Attributes

##### `kind`

Type: `enum(Unspecified | Internal | Server | Client | Producer | Consumer)`

The kind of the span.

Default value:

```json
"Unspecified"
```

##### `parentSpanID`

Type: `string`

The parent span ID that is being referenced as hex encoded string.

##### `spanEnd` [`required`]

Type: `time`

When the span ended.

##### `spanID` [`required`]

Type: `string`

The span ID that is being referenced.

##### `spanName` [`required`]

Type: `string`

The name of the span that is being collected.

##### `spanStart` [`required`]

Type: `time`

When the span started.

##### `statusCode`

Type: `enum(Unset | OK | Error)`

Status Code of a span.

Default value:

```json
"Unset"
```

##### `statusMessage`

Type: `string`

A developer-facing human readable error message.

##### `traceID` [`required`]

Type: `string`

The Trace ID that is being referenced as hex encoded string.

##### `transparentSpanID`

Type: `string`

The transparent span ID that is being referenced. If the application operates in
transparent tracing mode, then this field must be set to the span ID that this
span is originally referencing.
